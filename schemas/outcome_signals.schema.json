{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "OutcomeSignals",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "week_start",
    "garmin_summary",
    "mfp_summary"
  ],
  "properties": {
    "week_start": {
      "type": "string",
      "format": "date",
      "description": "ISO date (YYYY-MM-DD) of the Monday that starts this tracking week."
    },
    "generated_at": {
      "type": "string",
      "description": "ISO 8601 UTC timestamp when this file was last written by garmin_wellness_import."
    },
    "garmin_summary": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "avg_sleep_hr",
        "avg_steps",
        "training_load"
      ],
      "properties": {
        "avg_sleep_hr": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Average nightly sleep hours over the look-back window."
        },
        "avg_rhr": {
          "type": ["integer", "null"],
          "minimum": 20,
          "maximum": 120,
          "description": "Average resting heart rate (bpm) over the look-back window."
        },
        "avg_steps": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Average daily step count over the look-back window."
        },
        "training_load": {
          "type": "string",
          "enum": ["low", "moderate", "high", "unknown"],
          "description": "ACWR-derived training load classification for the most recent period."
        },
        "acwr": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Acute:Chronic Workload Ratio from Garmin (most recent value). <0.8=low, 0.8–1.3=optimal, >1.3=high."
        },
        "vo2max": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "VO2max in ml/kg/min from Garmin biometric profile."
        },
        "ftp_w": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Functional Threshold Power in watts from Garmin power zones / biometric profile."
        }
      }
    },
    "alcohol_summary": {
      "type": "object",
      "additionalProperties": false,
      "description": "Alcohol consumption signals from DrinkControl CSV export.",
      "required": [
        "units_7d",
        "units_28d_avg_wk",
        "kcal_7d",
        "drink_days_7d",
        "heaviest_day_7d",
        "last_drink_date",
        "days_since_drink",
        "flag",
        "recovery_note"
      ],
      "properties": {
        "units_7d": {
          "type": "number",
          "minimum": 0,
          "description": "USA standard drinks consumed in the last 7 days."
        },
        "units_28d_avg_wk": {
          "type": "number",
          "minimum": 0,
          "description": "Average USA units per week over the last 28 days."
        },
        "kcal_7d": {
          "type": "integer",
          "minimum": 0,
          "description": "Alcohol-derived calories in the last 7 days."
        },
        "drink_days_7d": {
          "type": "integer",
          "minimum": 0,
          "maximum": 7,
          "description": "Number of days with any alcohol in the last 7 days."
        },
        "heaviest_day_7d": {
          "type": "number",
          "minimum": 0,
          "description": "Peak USA units on a single day within the last 7 days."
        },
        "last_drink_date": {
          "type": ["string", "null"],
          "description": "ISO date (YYYY-MM-DD) of the most recent drink, or null."
        },
        "days_since_drink": {
          "type": ["integer", "null"],
          "minimum": 0,
          "description": "Calendar days since the last drink (0 = today), or null if no data."
        },
        "flag": {
          "type": "string",
          "enum": ["none", "light", "moderate", "heavy"],
          "description": "Consumption flag: none ≤2 units/7d, light ≤7, moderate ≤14, heavy >14."
        },
        "recovery_note": {
          "type": "string",
          "description": "Human-readable recovery context for the meal planner."
        }
      }
    },
    "mfp_summary": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "avg_kcal",
        "protein_g",
        "carbs_g",
        "fat_g"
      ],
      "properties": {
        "avg_kcal": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Average daily calories from MyFitnessPal (manual input; null if not logged)."
        },
        "protein_g": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Average daily protein grams from MFP (null if not logged)."
        },
        "carbs_g": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Average daily carbohydrate grams from MFP (null if not logged)."
        },
        "fat_g": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Average daily fat grams from MFP (null if not logged)."
        }
      }
    }
  }
}
